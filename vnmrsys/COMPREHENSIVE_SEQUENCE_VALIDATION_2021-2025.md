# Comprehensive Pulse Sequence Validation Report (2021-2025)

**Generated:** November 9, 2025
**Analysis Period:** 2021-2025 (5 years)
**Spectrometers:** Ayrshire, Ribeye, Taurus
**Total Experiments Analyzed:** 28,465

## Executive Summary

This report analyzes **5 years** of experimental data across **three spectrometers** to establish which pulse sequences are production-validated and which refactored sequences need testing.

### Key Findings

1. **28,465 total experiments** analyzed across Ayrshire (11,352), Ribeye (3,979), and Taurus (12,224)
2. **Top 10 sequences** account for 83% of all experiments
3. **4D sequences** (hXYXX_4D_S) heavily used: 2,137 experiments
4. **Ayrshire** is the workhorse spectrometer (40% of experiments)
5. **2023** was peak year (10,840 experiments)

## Overall Usage Rankings (2021-2025)

| Rank | Sequence | Total Uses | % of Total | Primary Spectrometer |
|------|----------|------------|------------|---------------------|
| 1 | **hX** | 8,841 | 31.1% | Ayrshire (2,910), Taurus (2,079), Ribeye (2,022) |
| 2 | **hXX** | 4,269 | 15.0% | Taurus (2,375), Ayrshire (1,271), Ribeye (623) |
| 3 | **hXH** | 3,427 | 12.0% | Ayrshire (1,863), Taurus (1,196), Ribeye (468) |
| 4 | **hXYXX_4D_S** | 2,137 | 7.5% | Ayrshire (1,310), Taurus (427) |
| 5 | **hYXH** | 1,785 | 6.3% | Ayrshire (798), Taurus (611), Ribeye (376) |
| 6 | **hYXX** | 1,511 | 5.3% | Ayrshire (1,000), Taurus (201) |
| 7 | **hYXX_S** | 1,361 | 4.8% | Ayrshire (665), Taurus (454), Ribeye (242) |
| 8 | **hXH_stppm** | 888 | 3.1% | Ayrshire only (644 + 244) |
| 9 | **hYyXH** | 471 | 1.7% | Taurus (250), Ayrshire (221) |
| 10 | **s2pul** | 459 | 1.6% | Utility/calibration |
| **Top 10 Total** | | **24,690** | **86.7%** | |

### Additional Important Sequences

| Rank | Sequence | Total Uses | Notes |
|------|----------|------------|-------|
| 11 | hX_stppm | 406 | Ayrshire only |
| 12 | ahXX | 321 | Taurus 2021 (experimental) |
| 13 | **hXXX_S** | 310 | Active production |
| 14 | onepul | 215 | Utility sequence |
| 15 | **ZF_TEDOR** | 197 | Production (Ayrshire 101, Taurus 96) |
| 16 | **HhXH** | 155 | Ribeye (99), Taurus (56) |
| 17 | H_19F_FSR_rfdr_hXH_stppm | 146 | Ayrshire 2023 |
| 18 | **hYYXH** | 107 | Recent increase (92 in Taurus 2025) |
| 19 | hX25cmr | 100 | Ribeye only |
| 20 | hXhhX | 95 | Mixed use |

## Year-by-Year Trends

### 2025 Activity (Through November)

**Total: 1,549 experiments** (Ayrshire: 907, Taurus: 642, Ribeye: 0)

**Note:** Ribeye appears inactive in 2025. Taurus had renovation downtime.

| Sequence | 2025 Uses | Peak Spectrometer |
|----------|-----------|-------------------|
| hX | 435 | Ayrshire (311) |
| hYXH | 247 | Ayrshire (186 Taurus, 61 Ayrshire) |
| hXH | 256 | Ayrshire (142 Taurus, 114 Ayrshire) |
| hXX | 136 | Ayrshire (110) |
| hYYXH | 107 | Taurus (92) - **Surging!** |
| hYXX_S | 96 | Ayrshire only |
| hXXXX_S | 84 | Ayrshire only |

**Key 2025 Observation:** hYYXH usage jumped dramatically in 2025 (92 uses on Taurus vs only 15 previous years).

### 2024 Activity

**Total: 5,545 experiments** (Ayrshire: 2,439, Ribeye: 1,603, Taurus: 1,503)

| Sequence | 2024 Uses | Notes |
|----------|-----------|-------|
| hX | 2,265 | Peak year for hX |
| hX_stppm | 406 | Ayrshire only |
| hXH | 693 | All spectrometers active |
| hXYXX_4D_S | 272 | Ayrshire 4D work |
| hXH_stppm | 244 | Ayrshire only |
| hYXX_S | 236 | Multi-spectrometer |
| hXX | 390 | Strong across all |
| ZF_TEDOR | 197 | Ayrshire (101), Taurus (96) |

### 2023 Activity (Peak Year!)

**Total: 10,840 experiments** (Ayrshire: 6,997, Taurus: 2,346, Ribeye: 1,497)

This was the most productive year with nearly 11,000 experiments!

| Sequence | 2023 Uses | Notes |
|----------|-----------|-------|
| hX | 3,320 | **Peak usage ever** |
| hXH | 2,180 | **Peak usage ever** |
| hYXH | 1,270 | **Peak usage ever** |
| hYXX | 805 | Strong production |
| hXYXX_4D_S | 728 | Major 4D campaign |
| hXH_stppm | 644 | Ayrshire specialty |
| hXX | 749 | Continued high use |
| s2pul | 317 | Many calibrations |
| hYyXH | 221 | Ayrshire only |

### 2022 Activity

**Total: 7,956 experiments** (Ayrshire: 3,012, Taurus: 4,065, Ribeye: 879)

Taurus was most active this year (51% of experiments).

| Sequence | 2022 Uses | Notes |
|----------|-----------|-------|
| hX | 2,392 | Strong year |
| **hXX** | **2,488** | **Peak year for hXX!** |
| hXYXX_4D_S | 1,081 | Major 4D work |
| hYXX_S | 770 | Peak year |
| hXH | 342 | Lower than typical |
| onepul | 115 | Calibrations |

### 2021 Activity

**Total: 2,577 experiments** (Ayrshire: 1,909, Taurus: 668, Ribeye: 0)

| Sequence | 2021 Uses | Notes |
|----------|-----------|-------|
| hX | 909 | Ayrshire (848), Taurus (61) |
| ahXX | 321 | Taurus experimental work |
| hXX | 506 | Both spectrometers |
| hYXX | 263 | Ayrshire only |
| hXhhX | 83 | Ayrshire only |

**Note:** 2021 Ayrshire data includes many VnmrJ/OpenVNMRJ standard sequences (tancp*, mqmas*, etc.) suggesting a system migration or testing period.

## Spectrometer-Specific Analysis

### Ayrshire (Workhorse)

**Total: 11,352 experiments (40% of all data)**
**Active Years:** 2021-2025 (all 5 years)
**Peak Year:** 2023 (6,997 experiments)

**Top Sequences:**
1. hX: 2,910 (26%)
2. hXH: 1,863 (16%)
3. hXYXX_4D_S: 1,310 (12%)
4. hXX: 1,271 (11%)
5. hYXX: 1,000 (9%)

**Characteristics:**
- Most versatile spectrometer
- Heavy 4D usage (hXYXX_4D_S)
- Unique sequences: hX_stppm, hXH_stppm variants
- 2023 was extraordinary year (7,000 experiments)

### Taurus (Versatile)

**Total: 12,224 experiments (43% of all data)**
**Active Years:** 2021-2025 (all 5 years)
**Peak Year:** 2022 (4,065 experiments)

**Top Sequences:**
1. hXX: 2,375 (19%) - **Taurus specialty!**
2. hX: 2,079 (17%)
3. hXH: 1,196 (10%)
4. hYXH: 611 (5%)
5. hYXX_S: 454 (4%)

**Characteristics:**
- **hXX workhorse** (56% of all hXX experiments)
- Experimental sequences (ahXX, ahX in 2021-2022)
- Recent hYYXH surge (92 in 2025)
- 2025 affected by renovation downtime

### Ribeye (Specialized)

**Total: 3,979 experiments (14% of all data)**
**Active Years:** 2022-2024 (3 years)
**Peak Year:** 2024 (1,603 experiments)

**Top Sequences:**
1. hX: 2,022 (51%) - **Highly specialized to hX!**
2. hXH: 468 (12%)
3. hXX: 623 (16%)
4. hYXH: 376 (9%)
5. HhXH: 99 (2%)

**Characteristics:**
- Most specialized spectrometer (51% just hX)
- Capital H sequences used here (HhXH: 99)
- Unique: hX25cmr (100 uses)
- **Inactive in 2025** (possible maintenance/decommission?)

## Refactored Sequences - Testing Priorities (Revised)

Based on 5 years of data across all spectrometers:

### CRITICAL PRIORITY (>1000 uses)

| Refactored Sequence | Parent Usage | Notes |
|---------------------|--------------|-------|
| **hXX-claude.c** (3 variants) | **4,269 uses** | #2 most used sequence! |
| (none exist yet) | hX: 8,841 uses | #1 sequence - no refactored version |
| (none exist yet) | hXH: 3,427 uses | #3 sequence - no refactored version |
| (none exist yet) | hXYXX_4D_S: 2,137 uses | #4 sequence - no refactored version |
| (none exist yet) | hYXH: 1,785 uses | #5 sequence - no refactored version |
| (none exist yet) | hYXX: 1,511 uses | #6 sequence - no refactored version |
| (none exist yet) | hYXX_S: 1,361 uses | #7 sequence - no refactored version |

### HIGH PRIORITY (100-1000 uses)

| Refactored Sequence | Parent Usage | Notes |
|---------------------|--------------|-------|
| **hYyXH-claude.c** | 471 uses | Refactored version exists |
| **hXXXX_S-claude.c** | 310 uses (as hXXX_S) | Need to verify naming |
| **hYYXH-claude.c** | 107 uses | **SURGING in 2025!** (92 in Taurus alone) |
| (none exist) | ZF_TEDOR: 197 uses | No refactored TEDOR yet |
| **HhXH-claude.c** | 155 uses | Refactored version exists |

### MEDIUM PRIORITY (50-100 uses)

| Refactored Sequence | Parent Usage | Notes |
|---------------------|--------------|-------|
| **HXhhXH_4D-claude.c** | 90 uses | 4D capital H sequence |
| **HhYXH-claude.c** | ~74 uses (as HhXX) | Verify parent |
| (none exist) | H_FSR_rfdr variants: 146+64 | REDOR family |

### LOW PRIORITY (<50 uses or specialized)

| Refactored Sequence | Parent Usage | Notes |
|---------------------|--------------|-------|
| **TEDOR-claude.c** | Part of 197 TEDOR uses | Specialized |
| **hYXX-claude.c** | Already covered by hYXX: 1,511 | May not need separate _S version |

## Critical Gaps in Refactoring

The July 2025 refactoring focused on some sequences but **missed the most heavily used ones**:

### Missing Refactored Versions for Top Sequences:

1. **hX** (8,841 uses) - NO refactored version
2. **hXH** (3,427 uses) - NO refactored version
3. **hXYXX_4D_S** (2,137 uses) - NO refactored version
4. **hYXH** (1,785 uses) - NO refactored version
5. **hYXX** (1,511 uses) - NO refactored version (hYXX-claude.c exists but may differ from hYXX_S)
6. **hYXX_S** (1,361 uses) - NO refactored version

### Refactored Versions That DO Exist:

1. ✓ **hXX** - 3 refactored versions! (hXX-claude.c, hXX_refactored.c, hXX_complete_refactor.c)
2. ✓ **hYYXH-claude.c** - Low historical use but SURGING in 2025
3. ✓ **hYyXH-claude.c** - 471 uses
4. ✓ **HhXH-claude.c** - 155 uses
5. ✓ **HhYXH-claude.c** - ~74 uses
6. ✓ **HXhhXH_4D-claude.c** - 90 uses
7. ✓ **hXXXX_S-claude.c** - 310 uses (verify naming)
8. ✓ **hYXX-claude.c** - May cover 1,511+1,361 uses
9. ✓ **TEDOR-claude.c** - Part of 197 TEDOR family

## Sequence Families - Production Status

### hX Family (Basic CP)
- **hX:** 8,841 uses ✓ Production validated
- **hX_stppm:** 406 uses ✓ Ayrshire specialty
- **hX-withYdec:** 52 uses ✓ Validated
- **hX_echoonly:** 23 uses ✓ Validated
- **hX-50pctduty:** 7 uses ✓ Low use
- **hX-noYdec:** 7 uses ✓ Low use

### hXX Family (2D CC)
- **hXX:** 4,269 uses ✓ Production validated - **TOP PRIORITY**
- **ahXX:** 321 uses ✓ Experimental (Taurus 2021)

### hXH Family (2D CH/NH)
- **hXH:** 3,427 uses ✓ Production validated
- **hXH_stppm:** 888 uses ✓ Ayrshire specialty

### hXYXX Family (4D)
- **hXYXX_4D_S:** 2,137 uses ✓ Production validated - **MAJOR WORKHORSE**

### hYXH Family (3D)
- **hYXH:** 1,785 uses ✓ Production validated
- **hYXH_S:** 17 uses ✓ Low use variant

### hYXX Family (3D)
- **hYXX:** 1,511 uses ✓ Production validated
- **hYXX_S:** 1,361 uses ✓ Production validated
- **hYXXsoft:** 84 uses ✓ Validated
- **hhYXX_S:** 90 uses ✓ Validated

### hYYXH Family (4D)
- **hYYXH:** 107 uses ✓ Production validated - **SURGING 2025!**
- **hYyXH:** 471 uses ✓ Production validated

### hXXX Family (3D)
- **hXXX_S:** 310 uses ✓ Production validated
- **hXXXX_S:** 84 uses ✓ Validated (Ayrshire 2025)
- **hXXX_S_nt2:** 30 uses ✓ Low use variant
- **hXXX_S_nt2_invert:** 5 uses ✓ Low use variant

### Capital H Family (Specialized)
- **HhXH:** 155 uses ✓ Production validated (Ribeye 99, Taurus 56)
- **HhXX:** 74 uses ✓ Validated
- **HXhhXH_4D:** 90 uses ✓ Production validated (Taurus 52, Ayrshire 36)
- **HhXH_T2filt:** 42 uses ✓ Validated (Taurus 2023)

### REDOR/TEDOR Family
- **ZF_TEDOR:** 197 uses ✓ Production validated
- **FS_REDOR:** 21 uses ✓ Validated
- **H_FSR_rfdr_hXH_stppm:** 146 uses ✓ Validated (Ayrshire 2023)
- **H_FSR_rfdr_hXH_prototype:** 64 uses ✓ Validated (Taurus 2023)

### Other Specialized
- **hXhhX:** 95 uses ✓ Validated
- **ahX:** 80 uses ✓ Experimental
- **hX25cmr:** 100 uses ✓ Ribeye specialty

## Recommendations

### Immediate Actions

1. **Test hXX refactored versions** - This is #2 most used sequence (4,269 uses)!
   - hXX-claude.c
   - hXX_refactored.c
   - hXX_complete_refactor.c

2. **Test hYYXH-claude.c** - SURGING in 2025 (92 uses in Taurus alone, up from 15 total in previous years)

3. **Verify Ribeye status** - No 2025 data (maintenance? decommissioned?)

### Future Refactoring Priorities

Based on usage data, future refactoring should prioritize:

1. **hX** (8,841 uses) - No refactored version exists!
2. **hXH** (3,427 uses) - No refactored version exists!
3. **hXYXX_4D_S** (2,137 uses) - Critical 4D workhorse, no refactored version
4. **hYXH** (1,785 uses) - No refactored version exists!
5. **hYXX / hYXX_S** (2,872 combined) - Verify if hYXX-claude.c covers both

### Testing Strategy

When at spectrometers for low-power testing:

**Phase 1: High-Impact Validation**
1. hXX refactored versions (4,269 parent uses)
2. hYYXH-claude.c (107 uses, surging trend)
3. hYyXH-claude.c (471 uses)

**Phase 2: Specialized Sequences**
4. HhXH-claude.c (155 uses, Ribeye specialty)
5. HXhhXH_4D-claude.c (90 uses, 4D work)
6. hXXXX_S-claude.c (310 uses)

**Phase 3: Lower Priority**
7. HhYXH-claude.c
8. hYXX-claude.c (verify coverage)
9. TEDOR-claude.c

## Data Quality and Coverage

### Total Experiments by Year
- 2021: 2,577
- 2022: 7,956
- 2023: 10,840 (PEAK)
- 2024: 5,545
- 2025: 1,549 (through Nov, partial year)

### Total Experiments by Spectrometer
- Ayrshire: 11,352 (40%)
- Taurus: 12,224 (43%)
- Ribeye: 3,979 (14%)
- **Note:** Ribeye inactive in 2025; Taurus affected by renovations

### Data Completeness
- ✓ All three spectrometers analyzed
- ✓ 5 complete years (2021-2024) + partial 2025
- ✓ 28,465 experiments with sequence names extracted
- ✓ Chronological trends identified
- ✓ Spectrometer specializations documented

## Conclusions

1. **The top 3 sequences (hX, hXX, hXH) account for 58% of all experiments** but only hXX has refactored versions.

2. **hXYXX_4D_S is a critical workhorse** (2,137 uses, #4 overall) with no refactored version.

3. **The July 2025 refactoring was well-targeted** for sequences needing modernization (hXX, hYYXH, Capital H family) but missed the highest-volume sequences.

4. **hYYXH is surging in 2025** - the refactored version should be prioritized for testing.

5. **Ayrshire and Taurus are the primary production spectrometers**; Ribeye appears more specialized (51% hX only) and may be inactive in 2025.

6. **2023 was the peak experimental year** with nearly 11,000 experiments, suggesting a major research campaign.

7. **All production sequences in the consolidated repository are validated** by real experimental use.

---

*This comprehensive analysis provides a solid foundation for prioritizing refactored sequence testing and future development work.*
